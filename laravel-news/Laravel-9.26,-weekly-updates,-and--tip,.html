<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">
<head>
<!--[if gte mso 15]>
  <xml>
      <o:OfficeDocumentSettings>
      <o:AllowPNG/>
      <o:PixelsPerInch>96</o:PixelsPerInch>
      </o:OfficeDocumentSettings>
  </xml>
  <![endif]--><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Laravel Shift Newsletter</title>
<style>
    body {
      font-family: Helvetica,Arial,sans-serif;
      font-size: 16px;
      color:#333333;
    }
    a {
      color: #f4645f;
      text-decoration: underline;
    }
    hr {
      border-top: 1px dashed #888;
      margin: 2em 0;
    }
    p, ul {
      margin-bottom:1em;
      line-height:1.5em;
    }
    h2 {
      color:#444;
      font-family:'Helvetica Neue',sans-serif;
      font-weight:600;
      font-size:20px;
      line-height:1.5;
      margin-top:2em;
    }
  </style>
</head>
<body style="font-family: Helvetica,Arial,sans-serif; font-size: 16px; color: #333333;">
<div style="max-width:600px;margin:0 0 0 1em;">
<p style="margin-bottom: 1em; line-height: 1.5em;">Heyo! JMac here again in the weekly newsletter with highlights from the Laravel patch release, Shift updates, and a ðŸ”¥ tip.</p>

<hr style="border-top: 1px dashed #888; margin: 2em 0;">
<h2 style="color: #444; font-family: 'Helvetica Neue',sans-serif; font-weight: 600; font-size: 20px; line-height: 1.5; margin-top: 2em;">Laravel 9.26</h2>
<p style="margin-bottom: 1em; line-height: 1.5em;">This week we got a new minor release with a fast-follow patch release bumping us to <strong>Laravel 9.26.1</strong>. Here are the highlights:</p>
<ul style="margin-bottom: 1em; line-height: 1.5em;">
<li>Add support for non-backed enums in <a href="https://github.com/laravel/framework/pull/43728" style="color: #f4645f; text-decoration: underline;">#43728</a>
</li>
<li>Improve display of failures for <code>assertDatabaseHas</code> in <a href="https://github.com/laravel/framework/pull/43736" style="color: #f4645f; text-decoration: underline;">#43736</a>
</li>
<li>Add <code>Vite::asset()</code> helper in <a href="https://github.com/laravel/framework/pull/43702" style="color: #f4645f; text-decoration: underline;">#43702</a>
</li>
<li>Support additional <code>where*</code> methods to route groups in <a href="https://github.com/laravel/framework/pull/43731" style="color: #f4645f; text-decoration: underline;">#43731</a>
</li>
<li>Add <code>min_digits</code> and <code>max_digits</code> validation rules in <a href="https://github.com/laravel/framework/pull/43797" style="color: #f4645f; text-decoration: underline;">#43797</a>
</li>
<li>Add closure support to dispatch conditionals. in <a href="https://github.com/laravel/framework/pull/43784" style="color: #f4645f; text-decoration: underline;">#43784</a>
</li>
<li>Add configurable paths to Vite in <a href="https://github.com/laravel/framework/pull/43620" style="color: #f4645f; text-decoration: underline;">#43620</a>
</li>
</ul>
<p style="margin-bottom: 1em; line-height: 1.5em;">You may review the <a href="https://github.com/laravel/framework/compare/v9.25.0...v9.26.1" style="color: #f4645f; text-decoration: underline;">full branch diff on GitHub</a> for a complete list of changes.</p>
<p style="margin-bottom: 1em; line-height: 1.5em;">This version bump and update is automated for subscribers to a <a href="https://laravelshift.com/shifty-plans" style="color: #f4645f; text-decoration: underline;">Shifty Plan</a>. If you don't have one of those, be sure to bump your constraint and run <code>composer update</code> to get the latest features.</p>
<h2 style="color: #444; font-family: 'Helvetica Neue',sans-serif; font-weight: 600; font-size: 20px; line-height: 1.5; margin-top: 2em;">Weekly Journal</h2>
<p style="margin-bottom: 1em; line-height: 1.5em;">Last week I worked on another <a href="https://laravelshift.com/human-shifts" style="color: #f4645f; text-decoration: underline;">Human Shift</a>. This time upgrading from Laravel 5.6 to Laravel 9.x. I also completed support for one from the previous week.</p>
<p style="margin-bottom: 1em; line-height: 1.5em;">I spent Friday cleaning up anything I noticed while dogfooding Shift. I also reviewed some of the recent support emails for any additional improvements.</p>
<p style="margin-bottom: 1em; line-height: 1.5em;">I spent most of yesterday backfilling tests to complete development for spawning new queue workers dynamically. I wanted to get this launched before today's release to test it in production.</p>
<p style="margin-bottom: 1em; line-height: 1.5em;">So today, with the tag of Laravel 9.26 (and 9.26.1), additional queue workers were dynamically created and removed within an hour of each release. This was pretty cool! I shared some screenshots and a follow-up video <a href="https://twitter.com/gonedark/status/1562162031846899712" style="color: #f4645f; text-decoration: underline;">on Twitter</a>. I also plan on writing a blog post which will focus more on the business decisions. I'll share that on Twitter once it's published, and in next week's newsletter.</p>
<p style="margin-bottom: 1em; line-height: 1.5em;">With the rest of this week I'll do another <a href="https://youtu.be/TpbkhR07W1g" style="color: #f4645f; text-decoration: underline;">Wednesday live stream</a>, as well as continue to tweak Shifts and likely the dynamic workers too.</p>
<h2 style="color: #444; font-family: 'Helvetica Neue',sans-serif; font-weight: 600; font-size: 20px; line-height: 1.5; margin-top: 2em;">ðŸ”¥ Tip</h2>
<p style="margin-bottom: 1em; line-height: 1.5em;">While testing the dynamic workers I stumbled upon a little <em>gotcha</em> when testing Laravel. Despite the implementation being correct, the following test failed.</p>
<pre><code>public function it_dispatches_job_to_destroy_worker()
{
    Queue::fake();
    Http::preventStrayRequests()
        -&gt;fake(['https://api.digitalocean.com/v2/droplets/54321' =&gt; Http::response('...');

    CheckWorker::dispatch(54321);

    Queue::assertPushed(
        DestroyWorker::class,
        fn ($job) =&gt; $job-&gt;id === 54321 &amp;&amp; $job-&gt;name === 'shift-worker-02'
    );
}
</code></pre>
<p style="margin-bottom: 1em; line-height: 1.5em;">Those that write a lot of Laravel tests or are very familiar with <em>fakes</em> may notice the reason right away. But it took me a little rubber ducking.</p>
<p style="margin-bottom: 1em; line-height: 1.5em;">When writing tests in Laravel, it's easy to write a query or fire an event or dispatch a job the same way you would within your application code. However, if you're faking one of Laravel's core components, it's possible that may no longer work.</p>
<p style="margin-bottom: 1em; line-height: 1.5em;">In this case, because I was faking the queue and then dispatching a job to the queue, the job itself never executed. It was simply recorded as being dispatched for testing purposes.</p>
<p style="margin-bottom: 1em; line-height: 1.5em;">To get around this, I wrote a simple helper method to dispatch the job manually.</p>
<pre><code>private function dispatchJob(int $id)
{
    (new CheckWorker($id))-&gt;handle();
}
</code></pre>
<p style="margin-bottom: 1em; line-height: 1.5em;">While I still prefer to use Laravel helpers in tests, for complex tests like this one (where jobs dispatch jobs), manually calling your code is an alternative.</p>


<hr style="border-top: 1px dashed #888; margin: 2em 0;">
<p style="margin-bottom: 1em; line-height: 1.5em;">As always, I welcome your feedback. <a href="https://laravelshift.com/" style="color: #f4645f; text-decoration: underline;">Keep Shifting!</a></p>

<p style="margin-bottom: 1em; line-height: 1.5em;">~ JMac</p>

<hr style="border-top: 1px dashed #888; margin: 2em 0;">
<p style="margin-bottom: 1em; line-height: 1.5em; color: #aaa; font-size: 12px;">Don't want to receive these updates? No problem, simply <a href="https://laravelshift.com/mailcoach/unsubscribe/c54bdd24-145c-42fe-a238-d0ba0eee4961/480fd56b-6f43-4148-8af6-1b02cc1caa14" style="color: #f4645f; text-decoration: underline;">unsubscribe</a> or sign into Shift and <a href="https://laravelshift.com/account/preferences" style="color: #f4645f; text-decoration: underline;">update your preferences</a>.</p>
<p style="margin-bottom: 1em; line-height: 1.5em; color: #aaa; font-size: 12px;">Proudly sent with <em>Mailcoach</em> from Louisville, Kentucky.</p>
</div>
<img width="1px" height="1px" alt="" src="http://email.mg.laravelshift.com/o/eJwVzMsNwyAMANBpyrGK8Uf4wDBgQ4MUFIlWmb_JAO-1DCIQlQA0eMZI2sLI1CU5dmMRrggOm7Ibx2hgIAov2o6yytWO7z76723nDHs2TXhXVmpyYCCvgp1rYiYWBwwrz7LsXOOa9_CZZRwP_QOBVyan"></body>
</html>
